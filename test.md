# テスト仕様書

## センサ関数テスト

### 1. センサ初期化テスト (testSensorInitialization)
- **目的**: センサクラスの初期状態を確認
- **期待値**: 
  - servoAngle = 0
  - robot = null
  - field = null

### 2. サーボ制御テスト (testServoControl)
- **目的**: サーボモーターの角度制御と範囲制限を確認
- **テストケース**:
  - 45度設定 → 45度
  - 100度設定 → 90度（上限クランプ）
  - -100度設定 → -90度（下限クランプ）

### 3. 距離センサー壁検知テスト (testDistanceSensorWithoutWalls)
- **目的**: 距離センサーが壁を検知しないことを確認
- **設定**: ロボット位置(4000, 4000)、フィールド8000×16000、ターゲットなし
- **期待値**: 最大測定距離4000mmを返す

### 4. 距離センサーターゲット検知テスト (testDistanceSensorWithTarget)
- **目的**: 距離センサーがターゲットを正しく検知することを確認
- **設定**: ロボット(1000, 1000)、ターゲット(1200, 1000)、半径30mm
- **期待値**: 約170-200mmの距離を返す

### 5. フォトセンサー境界検知テスト (testPhotoSensorBorderDetection)
- **目的**: フォトセンサーがフィールド境界の黒ラインを検知することを確認
- **設定**: ロボット(400, 400)、境界線幅500mm
- **期待値**: 左右両方のフォトセンサーがtrueを返す

### 6. フォトセンサーターゲット検知テスト (testPhotoSensorTargetDetection)
- **目的**: フォトセンサーがターゲット周囲の黒い円を検知することを確認
- **設定**: ロボット(1000, 1000)、ターゲット(1050, 1000)、半径30mm、黒円幅50mm
- **期待値**: 左右いずれかのフォトセンサーがtrueを返す

### 7. スタブ動作テスト (testStubBehavior)
- **目的**: ロボット/フィールドが未設定時のスタブ動作を確認
- **期待値**:
  - getDistance() → 0
  - getR_Photo() → false
  - getL_Photo() → false

## フィールドテスト（予定）

### 1. フィールド初期化テスト
- **目的**: フィールドサイズとターゲット配置の確認
- **期待値**: 
  - フィールドサイズ: 1600mm × 800mm
  - ターゲット数: 12個
  - ターゲット間隔: 400mm

### 2. スコアリングシステムテスト
- **目的**: ターゲット発見・再訪時のスコア計算を確認
- **期待値**:
  - 新規ターゲット発見: +10点
  - 既発見ターゲット再訪: +2点
  - 連続同一ターゲット訪問: 加算なし

### 3. ターゲット発見条件テスト
- **目的**: ターゲット発見の条件判定を確認
- **条件**: フォトセンサー黒検知 AND 距離センサー ≤ 13cm

## 安全性テスト

### 1. 衝突検知テスト (testCollisionDetection)
- **目的**: ロボットがフィールド境界に衝突する判定を確認
- **設定**: ロボット位置(40, 450)、サイズ300×300
- **期待値**: 衝突検知でゲームオーバー

### 2. 落下検知テスト (testFallOffDetection)
- **目的**: ロボットがフィールド外に落下する判定を確認
- **設定**: ロボット位置(-50, 450)、サイズ300×300
- **期待値**: 落下検知でゲームオーバー

### 3. ゲームオーバーシステムテスト (testGameOverSystem)
- **目的**: ゲームオーバー状態とリセット機能を確認
- **期待値**: 
  - 衝突/落下でゲームオーバー状態になる
  - リセットで正常状態に戻る

## 探索アルゴリズム安全機能テスト

### 1. フォトセンサによる境界回避
- **目的**: フォトセンサで黒ライン検知時の回避動作を確認
- **動作**: 黒ライン検知 → 後退回転で回避
- **全アルゴリズム**: 壁沿い、スパイラル、ランダム、格子、ターゲット追跡

### 2. 距離センサによる衝突回避  
- **目的**: 距離センサで近距離物体検知時の回避動作を確認
- **動作**: 距離≤150mm → 回転で回避
- **全アルゴリズム**: 壁沿い、スパイラル、ランダム、格子、ターゲット追跡